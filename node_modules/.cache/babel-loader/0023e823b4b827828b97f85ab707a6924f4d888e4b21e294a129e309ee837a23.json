{"ast":null,"code":"var _jsxFileName = \"D:\\\\proiecte\\\\frontend\\\\src\\\\pages\\\\Management.js\",\n  _s = $RefreshSig$();\nimport { Await, defer, json, redirect, useActionData, useRouteLoaderData } from \"react-router-dom\";\nimport { getAuthToken } from \"../utils/auth\";\nimport { Suspense } from \"react\";\nimport ProfileForm from \"../components/ProfileForm\";\nimport BookList from \"../components/BookList\";\nimport ClientList from \"../components/ClientList\";\nimport CategoryList from \"../components/CategoryList\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ManagementPage = () => {\n  _s();\n  const {\n    categories\n  } = useRouteLoaderData(\"management\");\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Suspense, {\n        fallback: /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: \"center\"\n          },\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 22,\n          columnNumber: 29\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(Await, {\n          resolve: categories,\n          children: loadedCat => /*#__PURE__*/_jsxDEV(CategoryList, {\n            categories: loadedCat\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 24,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 23,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n_s(ManagementPage, \"vZDfm0RSgfykU90ulj1YfNuJkKA=\", false, function () {\n  return [useRouteLoaderData];\n});\n_c = ManagementPage;\nexport default ManagementPage;\nexport const action = async ({\n  request,\n  params\n}) => {\n  const token = getAuthToken();\n  const data = await request.formData();\n  const catid = data.get(\"id\");\n  const catTitle = data.get(\"title\");\n  if (request.method === \"PATCH\") {\n    const response = await fetch(`http://localhost:8000/category/${catid}`, {\n      method: \"DELETE\",\n      headers: {\n        Authorization: \"Bearer \" + token,\n        \"Content-Type\": \"application/json\"\n      }\n    });\n  } else {\n    const response = await fetch(`http://localhost:8000/category/${catid}`, {\n      method: \"DELETE\",\n      headers: {\n        Authorization: \"Bearer \" + token,\n        \"Content-Type\": \"application/json\"\n      }\n    });\n  }\n  if (!response.ok) {\n    throw new Error(\"Failed to delete category\");\n  }\n  return true;\n};\nconst loadCategories = async () => {\n  const token = getAuthToken();\n  const response = await fetch(\"http://localhost:8000/category\", {\n    method: \"GET\",\n    headers: {\n      Authorization: \"Bearer \" + token\n    }\n  });\n  if (!response.ok) {\n    throw json({\n      message: \"Could not fetch my profile data!\"\n    }, {\n      status: 500\n    });\n  } else {\n    const resData = await response.json();\n    return resData.categories;\n  }\n};\nexport const loader = async ({\n  request,\n  params\n}) => {\n  const token = getAuthToken();\n  if (!token) {\n    return redirect(\"/auth?mode=login\");\n  }\n  return defer({\n    categories: loadCategories()\n  });\n};\nvar _c;\n$RefreshReg$(_c, \"ManagementPage\");","map":{"version":3,"names":["Await","defer","json","redirect","useActionData","useRouteLoaderData","getAuthToken","Suspense","ProfileForm","BookList","ClientList","CategoryList","jsxDEV","_jsxDEV","Fragment","_Fragment","ManagementPage","_s","categories","children","style","display","fallback","textAlign","fileName","_jsxFileName","lineNumber","columnNumber","resolve","loadedCat","_c","action","request","params","token","data","formData","catid","get","catTitle","method","response","fetch","headers","Authorization","ok","Error","loadCategories","message","status","resData","loader","$RefreshReg$"],"sources":["D:/proiecte/frontend/src/pages/Management.js"],"sourcesContent":["import {\r\n  Await,\r\n  defer,\r\n  json,\r\n  redirect,\r\n  useActionData,\r\n  useRouteLoaderData,\r\n} from \"react-router-dom\";\r\nimport { getAuthToken } from \"../utils/auth\";\r\nimport { Suspense } from \"react\";\r\nimport ProfileForm from \"../components/ProfileForm\";\r\nimport BookList from \"../components/BookList\";\r\nimport ClientList from \"../components/ClientList\";\r\nimport CategoryList from \"../components/CategoryList\";\r\n\r\nconst ManagementPage = () => {\r\n  const { categories } = useRouteLoaderData(\"management\");\r\n\r\n  return (\r\n    <>\r\n      <div style={{ display: \"flex\" }}>\r\n        <Suspense fallback={<p style={{ textAlign: \"center\" }}>Loading...</p>}>\r\n          <Await resolve={categories}>\r\n            {(loadedCat) => <CategoryList categories={loadedCat} />}\r\n          </Await>\r\n        </Suspense>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ManagementPage;\r\n\r\nexport const action = async ({ request, params }) => {\r\n  const token = getAuthToken();\r\n  const data=await request.formData();\r\n  const catid=data.get(\"id\")\r\n  const catTitle=data.get(\"title\")\r\n\r\nif(request.method === \"PATCH\"){\r\n  const response = await fetch(`http://localhost:8000/category/${catid}`, {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      Authorization: \"Bearer \" + token,\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  })\r\n}else{\r\n  const response = await fetch(`http://localhost:8000/category/${catid}`, {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      Authorization: \"Bearer \" + token,\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  })\r\n}\r\n\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to delete category\");\r\n  }\r\n  return true;\r\n};\r\n\r\n\r\nconst loadCategories = async () => {\r\n  const token = getAuthToken();\r\n\r\n  const response = await fetch(\"http://localhost:8000/category\", {\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: \"Bearer \" + token,\r\n    },\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw json(\r\n      {\r\n        message: \"Could not fetch my profile data!\",\r\n      },\r\n      {\r\n        status: 500,\r\n      }\r\n    );\r\n  } else {\r\n    const resData = await response.json();\r\n\r\n    return resData.categories;\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const loader = async ({ request, params }) => {\r\n  const token = getAuthToken();\r\n\r\n  if (!token) {\r\n    return redirect(\"/auth?mode=login\");\r\n  }\r\n\r\n  return defer({\r\n\r\n    categories: loadCategories(),\r\n\r\n  });\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}