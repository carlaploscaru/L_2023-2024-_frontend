{"ast":null,"code":"var _jsxFileName = \"D:\\\\proiecte\\\\frontend\\\\src\\\\pages\\\\Profile.js\",\n  _s = $RefreshSig$();\nimport { Await, defer, json, redirect, useActionData, useRouteLoaderData } from \"react-router-dom\";\nimport { getAuthToken } from \"../utils/auth\";\nimport { Suspense } from \"react\";\nimport ProfileForm from \"../components/ProfileForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ProfilePage = () => {\n  _s();\n  const data = useActionData();\n  const {\n    user\n  } = useRouteLoaderData(\"me\");\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: true,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 19,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\" \", /*#__PURE__*/_jsxDEV(Suspense, {\n          fallback: /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              textAlign: \"center\"\n            },\n            children: \"Loading...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 20,\n            columnNumber: 35\n          }, this),\n          children: /*#__PURE__*/_jsxDEV(Await, {\n            resolve: user,\n            children: loadedUser => /*#__PURE__*/_jsxDEV(ProfileForm, {\n              user: loadedUser\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 22,\n              columnNumber: 30\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 21,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 20,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n_s(ProfilePage, \"35V2B0dV2lNKj3K1H0atNzgeGmE=\", false, function () {\n  return [useActionData, useRouteLoaderData];\n});\n_c = ProfilePage;\nexport default ProfilePage;\nexport const action = async ({\n  request,\n  params\n}) => {\n  const token = getAuthToken();\n  const aaa = await request.formData();\n  const data = Object.fromEntries(aaa);\n  const formData = new FormData();\n  formData.append(\"name\", data.name);\n  formData.append(\"image\", data.images);\n  const response = await fetch(\"http://localhost:8000/user/me\", {\n    method: \"PATCH\",\n    headers: {\n      Authorization: \"Bearer \" + token\n    },\n    body: formData\n  });\n  return response;\n};\nconst loadMe = async () => {\n  const token = getAuthToken();\n  const response = await fetch(\"http://localhost:8000/user/me\", {\n    method: \"GET\",\n    headers: {\n      Authorization: \"Bearer \" + token\n    }\n  });\n  if (!response.ok) {\n    throw json({\n      message: \"Could not fetch my profile data!\"\n    }, {\n      status: 500\n    });\n  } else {\n    const resData = await response.json();\n    console.log(resData.me);\n    return resData.me;\n  }\n};\nexport const loader = async ({\n  request,\n  params\n}) => {\n  const token = getAuthToken();\n  if (!token) {\n    return redirect(\"/auth?mode=login\");\n  }\n  return defer({\n    user: loadMe()\n  });\n};\nvar _c;\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"names":["Await","defer","json","redirect","useActionData","useRouteLoaderData","getAuthToken","Suspense","ProfileForm","jsxDEV","_jsxDEV","Fragment","_Fragment","ProfilePage","_s","data","user","children","style","fileName","_jsxFileName","lineNumber","columnNumber","fallback","textAlign","resolve","loadedUser","_c","action","request","params","token","aaa","formData","Object","fromEntries","FormData","append","name","images","response","fetch","method","headers","Authorization","body","loadMe","ok","message","status","resData","console","log","me","loader","$RefreshReg$"],"sources":["D:/proiecte/frontend/src/pages/Profile.js"],"sourcesContent":["import {\r\n    Await,\r\n    defer,\r\n    json,\r\n    redirect,\r\n    useActionData,\r\n    useRouteLoaderData,\r\n  } from \"react-router-dom\";\r\n  import { getAuthToken } from \"../utils/auth\";\r\n  import { Suspense } from \"react\";\r\n  import ProfileForm from \"../components/ProfileForm\";\r\n  \r\n  const ProfilePage = () => {\r\n    const data = useActionData();\r\n    const { user } = useRouteLoaderData(\"me\");\r\n    return (\r\n      <>\r\n      <div style>\r\n        <div></div>\r\n        <div> <Suspense fallback={<p style={{ textAlign: \"center\" }}>Loading...</p>}>\r\n          <Await resolve={user}>\r\n            {(loadedUser) => <ProfileForm user={loadedUser} />}\r\n          </Await>\r\n        </Suspense></div>\r\n      </div>\r\n      </>\r\n    );\r\n  };\r\n  \r\n  export default ProfilePage;\r\n  \r\n  export const action = async ({ request, params }) => {\r\n    const token = getAuthToken();\r\n  \r\n    const aaa = await request.formData();\r\n  \r\n    const data = Object.fromEntries(aaa);\r\n    \r\n  \r\n    const formData = new FormData();\r\n  \r\n    formData.append(\"name\", data.name);\r\n    formData.append(\"image\", data.images);\r\n  \r\n    const response = await fetch(\"http://localhost:8000/user/me\", {\r\n      method: \"PATCH\",\r\n      headers: {\r\n        Authorization: \"Bearer \" + token,\r\n      },\r\n      body: formData,\r\n    });\r\n  \r\n    return response;\r\n  };\r\n  \r\n  const loadMe = async () => {\r\n    const token = getAuthToken();\r\n  \r\n    const response = await fetch(\"http://localhost:8000/user/me\", {\r\n      method: \"GET\",\r\n      headers: {\r\n        Authorization: \"Bearer \" + token,\r\n      },\r\n    });\r\n  \r\n    if (!response.ok) {\r\n      throw json(\r\n        {\r\n          message: \"Could not fetch my profile data!\",\r\n        },\r\n        {\r\n          status: 500,\r\n        }\r\n      );\r\n    } else {\r\n      const resData = await response.json();\r\n  \r\n      console.log(resData.me);\r\n      return resData.me;\r\n    }\r\n  };\r\n  \r\n  export const loader = async ({ request, params }) => {\r\n    const token = getAuthToken();\r\n  \r\n    if (!token) {\r\n      return redirect(\"/auth?mode=login\");\r\n    }\r\n  \r\n    return defer({\r\n      user: loadMe(),\r\n    });\r\n  };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}