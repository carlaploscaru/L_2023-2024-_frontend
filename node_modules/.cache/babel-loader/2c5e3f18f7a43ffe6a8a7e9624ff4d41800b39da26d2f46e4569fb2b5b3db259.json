{"ast":null,"code":"var _jsxFileName = \"D:\\\\proiecte\\\\frontend\\\\src\\\\pages\\\\Profile.js\",\n  _s = $RefreshSig$();\nimport { Await, defer, json, redirect, useActionData, useRouteLoaderData } from \"react-router-dom\";\nimport { getAuthToken } from \"../utils/auth\";\nimport { Suspense } from \"react\";\nimport ProfileForm from \"../components/ProfileForm\";\nimport BookList from \"../components/BookList\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ProfilePage = () => {\n  _s();\n  const data = useActionData();\n  const {\n    user,\n    reservations\n  } = useRouteLoaderData(\"me\");\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        displey: \"flex\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Suspense, {\n        fallback: /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: \"center\"\n          },\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 21,\n          columnNumber: 29\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(Await, {\n          resolve: reservations,\n          children: loadedRezv => /*#__PURE__*/_jsxDEV(BookList, {\n            reservations: loadedRezv\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 23,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 22,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Suspense, {\n        fallback: /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: \"center\"\n          },\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 28,\n          columnNumber: 29\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(Await, {\n          resolve: user,\n          children: loadedUser => /*#__PURE__*/_jsxDEV(ProfileForm, {\n            user: loadedUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 30,\n            columnNumber: 30\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 29,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n_s(ProfilePage, \"mK73GY5t+ABkVClVPYIPPFSobRA=\", false, function () {\n  return [useActionData, useRouteLoaderData];\n});\n_c = ProfilePage;\nexport default ProfilePage;\nexport const action = async ({\n  request,\n  params\n}) => {\n  const token = getAuthToken();\n  const aaa = await request.formData();\n  const data = Object.fromEntries(aaa);\n  const formData = new FormData();\n  formData.append(\"name\", data.name);\n  formData.append(\"image\", data.images);\n  const response = await fetch(\"http://localhost:8000/user/me\", {\n    method: \"PATCH\",\n    headers: {\n      Authorization: \"Bearer \" + token\n    },\n    body: formData\n  });\n  return response;\n};\nconst loadRezervations = async () => {\n  const token = getAuthToken();\n  const response = await fetch(\"http://localhost:8000/sale\", {\n    method: \"GET\",\n    headers: {\n      Authorization: \"Bearer \" + token\n    }\n  });\n  if (!response.ok) {\n    throw json({\n      message: \"Could not fetch my profile data!\"\n    }, {\n      status: 500\n    });\n  } else {\n    const resData = await response.json();\n    console.log(resData.reservations);\n    return resData.reservations;\n  }\n};\nconst loadMe = async () => {\n  const token = getAuthToken();\n  const response = await fetch(\"http://localhost:8000/user/me\", {\n    method: \"GET\",\n    headers: {\n      Authorization: \"Bearer \" + token\n    }\n  });\n  if (!response.ok) {\n    throw json({\n      message: \"Could not fetch my profile data!\"\n    }, {\n      status: 500\n    });\n  } else {\n    const resData = await response.json();\n    console.log(resData.me);\n    return resData.me;\n  }\n};\nexport const loader = async ({\n  request,\n  params\n}) => {\n  const token = getAuthToken();\n  if (!token) {\n    return redirect(\"/auth?mode=login\");\n  }\n  return defer({\n    user: loadMe(),\n    reservations: loadRezervations()\n  });\n};\nvar _c;\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"names":["Await","defer","json","redirect","useActionData","useRouteLoaderData","getAuthToken","Suspense","ProfileForm","BookList","jsxDEV","_jsxDEV","Fragment","_Fragment","ProfilePage","_s","data","user","reservations","children","style","displey","fallback","textAlign","fileName","_jsxFileName","lineNumber","columnNumber","resolve","loadedRezv","loadedUser","_c","action","request","params","token","aaa","formData","Object","fromEntries","FormData","append","name","images","response","fetch","method","headers","Authorization","body","loadRezervations","ok","message","status","resData","console","log","loadMe","me","loader","$RefreshReg$"],"sources":["D:/proiecte/frontend/src/pages/Profile.js"],"sourcesContent":["import {\r\n  Await,\r\n  defer,\r\n  json,\r\n  redirect,\r\n  useActionData,\r\n  useRouteLoaderData,\r\n} from \"react-router-dom\";\r\nimport { getAuthToken } from \"../utils/auth\";\r\nimport { Suspense } from \"react\";\r\nimport ProfileForm from \"../components/ProfileForm\";\r\nimport BookList from \"../components/BookList\";\r\n\r\nconst ProfilePage = () => {\r\n  const data = useActionData();\r\n  const { user, reservations } = useRouteLoaderData(\"me\");\r\n  \r\n  return (\r\n    <>\r\n      <div style={{ displey: \"flex\" }}>\r\n        <Suspense fallback={<p style={{ textAlign: \"center\" }}>Loading...</p>}>\r\n          <Await resolve={reservations}>\r\n            {(loadedRezv)=> <BookList reservations={loadedRezv}/>}\r\n          </Await>\r\n        </Suspense>\r\n\r\n\r\n        <Suspense fallback={<p style={{ textAlign: \"center\" }}>Loading...</p>}>\r\n          <Await resolve={user}>\r\n            {(loadedUser) => <ProfileForm user={loadedUser} />}\r\n          </Await>\r\n        </Suspense>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProfilePage;\r\n\r\nexport const action = async ({ request, params }) => {\r\n  const token = getAuthToken();\r\n\r\n  const aaa = await request.formData();\r\n\r\n  const data = Object.fromEntries(aaa);\r\n\r\n\r\n  const formData = new FormData();\r\n\r\n  formData.append(\"name\", data.name);\r\n  formData.append(\"image\", data.images);\r\n\r\n  const response = await fetch(\"http://localhost:8000/user/me\", {\r\n    method: \"PATCH\",\r\n    headers: {\r\n      Authorization: \"Bearer \" + token,\r\n    },\r\n    body: formData,\r\n  });\r\n\r\n  return response;\r\n};\r\n\r\n\r\nconst loadRezervations = async () => {\r\n  const token = getAuthToken();\r\n\r\n  const response = await fetch(\"http://localhost:8000/sale\", {\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: \"Bearer \" + token,\r\n    },\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw json(\r\n      {\r\n        message: \"Could not fetch my profile data!\",\r\n      },\r\n      {\r\n        status: 500,\r\n      }\r\n    );\r\n  } else {\r\n    const resData = await response.json();\r\n\r\n    console.log(resData.reservations);\r\n    return resData.reservations;\r\n  }\r\n\r\n}\r\n\r\nconst loadMe = async () => {\r\n  const token = getAuthToken();\r\n\r\n  const response = await fetch(\"http://localhost:8000/user/me\", {\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: \"Bearer \" + token,\r\n    },\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw json(\r\n      {\r\n        message: \"Could not fetch my profile data!\",\r\n      },\r\n      {\r\n        status: 500,\r\n      }\r\n    );\r\n  } else {\r\n    const resData = await response.json();\r\n\r\n    console.log(resData.me);\r\n    return resData.me;\r\n  }\r\n};\r\n\r\nexport const loader = async ({ request, params }) => {\r\n  const token = getAuthToken();\r\n\r\n  if (!token) {\r\n    return redirect(\"/auth?mode=login\");\r\n  }\r\n\r\n  return defer({\r\n    user: loadMe(),\r\n    reservations: loadRezervations(),\r\n  });\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}