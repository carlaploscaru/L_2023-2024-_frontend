{"ast":null,"code":"var _jsxFileName = \"D:\\\\proiecte\\\\frontend\\\\src\\\\pages\\\\Properties.js\",\n  _s = $RefreshSig$();\nimport { Suspense } from \"react\";\nimport { Await, defer, json, redirect, useLoaderData, useRouteLoaderData } from \"react-router-dom\";\nimport PropertyList from \"../components/PropertyList\";\nimport { getAuthToken } from \"../utils/auth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PropertiesPage = () => {\n  _s();\n  const {\n    properties\n  } = useLoaderData();\n  return /*#__PURE__*/_jsxDEV(Suspense, {\n    fallback: /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        textAlign: \"center\"\n      },\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 10,\n      columnNumber: 25\n    }, this),\n    children: /*#__PURE__*/_jsxDEV(Await, {\n      resolve: properties,\n      children: loadedProperties => /*#__PURE__*/_jsxDEV(PropertyList, {\n        properties: loadedProperties\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 12,\n        columnNumber: 32\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 11,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 10,\n    columnNumber: 5\n  }, this);\n};\n_s(PropertiesPage, \"YdesAtQOYcU1V3/7Lcr7sTDZE0w=\", false, function () {\n  return [useLoaderData];\n});\n_c = PropertiesPage;\nconst loadProperties = async filterArray => {\n  const token = getAuthToken();\n  let response;\n  if (Object.keys(filterArray).length === 0) {\n    response = await fetch(`http://localhost:8000/place`, {\n      method: \"GET\",\n      headers: {\n        Authorization: \"Bearer \" + token\n      }\n    });\n  } else {\n    response = await fetch(`http://localhost:8000/place?tara=${filterArray[\"tara\"]}&oras=${filterArray[\"oras\"]}&data_start=${filterArray[\"data_start\"]}&data_end=${filterArray[\"category\"]}`, {\n      method: \"GET\",\n      headers: {\n        Authorization: \"Bearer \" + token\n      }\n    });\n  }\n  if (!response.ok) {\n    throw json({\n      message: \"Could not fetch properties\"\n    }, {\n      status: 500\n    });\n  } else {\n    const resData = await response.json();\n    return resData.places;\n  }\n};\nexport function loader({\n  request\n}) {\n  let cleanFilterArray = {};\n  if (request.url.includes(\"?\")) {\n    const paramsFilterArray = request.url.split(\"//\")[1].split(\"/\")[1].split(\"?\")[1].split(\"&\");\n    paramsFilterArray.forEach(element => {\n      const elementArray = element.split(\"=\");\n      console.log(elementArray);\n      cleanFilterArray[elementArray[0]] = elementArray[1];\n    });\n  }\n  const token = getAuthToken();\n  if (!token) {\n    return redirect('/auth?mode=login');\n  }\n  return defer({\n    //pt Suspense de sus\n    properties: loadProperties(cleanFilterArray)\n  });\n}\nexport default PropertiesPage;\nvar _c;\n$RefreshReg$(_c, \"PropertiesPage\");","map":{"version":3,"names":["Suspense","Await","defer","json","redirect","useLoaderData","useRouteLoaderData","PropertyList","getAuthToken","jsxDEV","_jsxDEV","PropertiesPage","_s","properties","fallback","style","textAlign","children","fileName","_jsxFileName","lineNumber","columnNumber","resolve","loadedProperties","_c","loadProperties","filterArray","token","response","Object","keys","length","fetch","method","headers","Authorization","ok","message","status","resData","places","loader","request","cleanFilterArray","url","includes","paramsFilterArray","split","forEach","element","elementArray","console","log","$RefreshReg$"],"sources":["D:/proiecte/frontend/src/pages/Properties.js"],"sourcesContent":["import { Suspense } from \"react\";\r\nimport { Await, defer, json, redirect, useLoaderData, useRouteLoaderData } from \"react-router-dom\"\r\nimport PropertyList from \"../components/PropertyList\";\r\nimport { getAuthToken } from \"../utils/auth\";\r\n\r\nconst PropertiesPage = () => {\r\n  const { properties } = useLoaderData();\r\n\r\n  return (\r\n    <Suspense fallback={<p style={{ textAlign: \"center\" }}>Loading...</p>}>\r\n      <Await resolve={properties}>\r\n        {(loadedProperties) => <PropertyList properties={loadedProperties} />}\r\n      </Await>\r\n    </Suspense>\r\n  );\r\n}\r\n\r\n\r\n\r\nconst loadProperties = async (filterArray) => {\r\n    const token = getAuthToken();\r\n    let response;\r\n    if (Object.keys(filterArray).length === 0) {\r\n      response = await fetch(`http://localhost:8000/place`, {\r\n        method: \"GET\",\r\n        headers: {\r\n          Authorization: \"Bearer \" + token,\r\n        },\r\n      });\r\n    } else {\r\n      response = await fetch(\r\n        `http://localhost:8000/place?tara=${filterArray[\"tara\"]}&oras=${filterArray[\"oras\"]}&data_start=${filterArray[\"data_start\"]}&data_end=${filterArray[\"category\"]}`,\r\n        {\r\n          method: \"GET\",\r\n          headers: {\r\n            Authorization: \"Bearer \" + token,\r\n          },\r\n        }\r\n      );\r\n    }\r\n  \r\n    if (!response.ok) {\r\n      throw json({ message: \"Could not fetch properties\" }, { status: 500 });\r\n    } else {\r\n      const resData = await response.json();\r\n  \r\n\r\n\r\n      return resData.places;\r\n    }\r\n  };\r\n  \r\n  export function loader({request}) {\r\n\r\n    let cleanFilterArray = {};\r\n    if (request.url.includes(\"?\")) {\r\n      const paramsFilterArray = request.url\r\n        .split(\"//\")[1]\r\n        .split(\"/\")[1]\r\n        .split(\"?\")[1]\r\n        .split(\"&\");\r\n      paramsFilterArray.forEach((element) => {\r\n        const elementArray = element.split(\"=\");\r\n        console.log(elementArray);\r\n        cleanFilterArray[elementArray[0]] = elementArray[1];\r\n      });\r\n    }\r\n\r\n    const  token  = getAuthToken();\r\n    if(!token) {\r\n      return redirect('/auth?mode=login');\r\n    }\r\n  \r\n    return defer({//pt Suspense de sus\r\n      properties: loadProperties(cleanFilterArray),\r\n    });\r\n  }\r\n  \r\n\r\nexport default PropertiesPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}